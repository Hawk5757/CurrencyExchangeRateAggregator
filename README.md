Currency Exchange Rate Aggregator

## Початкове Технічне Завдання (ТЗ)

### User Story:
"Як користувач, я хочу аналізувати курс гривні до долара, а також мати можливість подивитися середній курс за певний період, щоб приймати рішення про купівлю чи продаж валюти."

### Description:
Реалізувати сервіс, який отримує курс гривні до долара США з відкритого джерела, та надає REST-інтерфейс для доступу до поточного та середнього курсу за вибраний період.
Мета — оцінити технічну компетентність кандидата, вміння працювати з API, організовувати структуру застосунку, а також реалізовувати бізнес-логіку з урахуванням збереження й агрегування даних.

### Acceptance Criteria:
1.  Є змога отримати дані курсу валют UAH/USD за певну дату.
2.  Є змога отримати середньодобове значення курсу за період.

### Notes:
* Джерело даних: API НБУ або інший публічний API з курсами валют (тільки офіційний курс UAH/USD).
* База даних: SQLite, InMemory або інша, на вибір кандидата.
* Сервіс в подальшому має бути без проблем інтегрований з іншим сервісом чи веб-додатком.
* Для тестового завдання достатньо буде збирати дані не старше 3х місяців.

---

## Загальний опис рішення

Цей проєкт є ASP.NET Core Web API, призначеним для агрегації та надання історичних і поточних курсів обміну валют (наразі UAH/USD) від Національного банку України (НБУ). Він дозволяє ефективно отримувати, зберігати та надавати дані про курси валют, забезпечуючи при цьому стійкість до тимчасових проблем із зовнішніми API та оптимальну продуктивність бази даних.

Основні функціональні можливості:
* Отримання курсів валют за конкретну дату або період.
* Отримання останнього доступного курсу.
* Зберігання отриманих даних у локальній базі даних SQLite для швидкого доступу та зменшення кількості запитів до зовнішніх сервісів.
* Підтримка обмежень на глибину історії даних (data retention) для оптимізації зберігання.

## Ключові технології та бібліотеки

* **ASP.NET Core**: Фреймворк для побудови веб-API.
* **Entity Framework Core**: ORM для взаємодії з базою даних SQLite.
* **NLog**: Гнучка бібліотека для логування подій застосунку.
* **Polly**: Бібліотека для реалізації політик стійкості (таких як повторні спроби - retries) для HTTP-запитів.
* **Swagger/OpenAPI**: Для автоматичної генерації документації API та зручного тестування.

## Покращення та оптимізації

У процесі розробки та вдосконалення рішення були імплементовані наступні важливі покращення:

1.  **Логування (NLog)**:
    * Впроваджено централізоване логування за допомогою NLog, що дозволяє відстежувати роботу застосунку, ідентифікувати помилки та попередження. Логи записуються як у консоль, так і в файли за датою.
2.  **Механізм повторних спроб (Retries) для HTTP-запитів (Polly)**:
    * Додано політику повторних спроб на HTTP-запити до зовнішнього API НБУ за допомогою бібліотеки Polly. Це підвищує стійкість застосунку до тимчасових мережевих проблем або перевантаження зовнішнього сервісу, автоматично повторюючи запити з експоненціальною затримкою.
3.  **Оптимізація роботи з базою даних**:
    * **Пакетне додавання/оновлення записів**: Замість поодиноких операцій запису в базу даних, реалізовано механізм пакетного додавання та оновлення курсів (метод `AddOrUpdateRatesAsync` у `CurrencyRepository`). Це значно зменшує кількість звернень до БД та підвищує продуктивність при синхронізації великої кількості даних.
    * **Індекси в базі даних**: Додано унікальний індекс на поле `Date` у таблиці `CurrencyRates`. Це значно прискорює пошук, фільтрацію та сортування даних за датою, оптимізуючи запити до бази даних.
4.  **Винесення бізнес-логіки**:
    * Бізнес-логіка, така як обчислення середнього курсу (`GetAverageRate`), була винесена з контролера в окремий сервісний шар (`ICurrencyService`), що підвищує модульність, тестування та читабельність коду.
5.  **Оптимізація `using` директив**:
    * Видалено зайві (`unnecessary`) `using` директиви в коді, особливо ті, які автоматично імпортуються завдяки функції **Implicit Usings** у сучасних версіях .NET. Це покращує читабельність та чистоту коду.
6.  **Кешування в пам'яті (IMemoryCache)**:
    * Впроваджено кешування даних про курси валют у пам'яті застосунку за допомогою `IMemoryCache`. Це дозволяє значно прискорити повторні запити на вже отримані дати, зменшуючи навантаження на базу даних та зовнішні API, і забезпечуючи блискавичну відповідь для часто запитуваних даних.

## Початок роботи

### Передумови

* .NET SDK (рекомендовано .NET 8.0 або вище)
* IDE: Rider або Visual Studio

### Клонування репозиторію

```bash
git clone [https://github.com/Hawk5757/CurrencyExchangeRateAggregator.git](https://github.com/Hawk5757/CurrencyExchangeRateAggregator.git)
cd CurrencyExchangeRateAggregator