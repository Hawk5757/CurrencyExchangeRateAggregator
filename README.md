# Currency Exchange Rate Aggregator

## Загальний опис рішення

Цей проєкт є ASP.NET Core Web API, призначеним для агрегації та надання історичних і поточних курсів обміну валют (наразі UAH/USD) від Національного банку України (НБУ). Він дозволяє ефективно отримувати, зберігати та надавати дані про курси валют, забезпечуючи при цьому стійкість до тимчасових проблем із зовнішніми API та оптимальну продуктивність бази даних.

Основні функціональні можливості:
* Отримання курсів валют за конкретну дату або період.
* Отримання останнього доступного курсу.
* Зберігання отриманих даних у локальній базі даних SQLite для швидкого доступу та зменшення кількості запитів до зовнішніх сервісів.
* Підтримка обмежень на глибину історії даних (data retention) для оптимізації зберігання.

## Ключові технології та бібліотеки

* **ASP.NET Core**: Фреймворк для побудови веб-API.
* **Entity Framework Core**: ORM для взаємодії з базою даних SQLite.
* **NLog**: Гнучка бібліотека для логування подій застосунку.
* **Polly**: Бібліотека для реалізації політик стійкості (таких як повторні спроби - retries) для HTTP-запитів.
* **Swagger/OpenAPI**: Для автоматичної генерації документації API та зручного тестування.

## Покращення та оптимізації

У процесі розробки та вдосконалення рішення були імплементовані наступні важливі покращення:

1.  **Логування (NLog)**:
    * Впроваджено централізоване логування за допомогою NLog, що дозволяє відстежувати роботу застосунку, ідентифікувати помилки та попередження. Логи записуються як у консоль, так і в файли за датою.
2.  **Механізм повторних спроб (Retries) для HTTP-запитів (Polly)**:
    * Додано політику повторних спроб на HTTP-запити до зовнішнього API НБУ за допомогою бібліотеки Polly. Це підвищує стійкість застосунку до тимчасових мережевих проблем або перевантаження зовнішнього сервісу, автоматично повторюючи запити з експоненціальною затримкою.
3.  **Оптимізація роботи з базою даних**:
    * **Пакетне додавання/оновлення записів**: Замість поодиноких операцій запису в базу даних, реалізовано механізм пакетного додавання та оновлення курсів (метод `AddOrUpdateRatesAsync` у `CurrencyRepository`). Це значно зменшує кількість звернень до БД та підвищує продуктивність при синхронізації великої кількості даних.
    * **Індекси в базі даних**: Додано унікальний індекс на поле `Date` у таблиці `CurrencyRates`. Це значно прискорює пошук, фільтрацію та сортування даних за датою, оптимізуючи запити до бази даних.
4.  **Винесення бізнес-логіки**:
    * Бізнес-логіка, така як обчислення середнього курсу (`GetAverageRate`), була винесена з контролера в окремий сервісний шар (`ICurrencyService`), що підвищує модульність, тестування та читабельність коду.

## Початок роботи

### Передумови

* .NET SDK (рекомендовано .NET 8.0 або вище)
* IDE: Rider або Visual Studio

### Клонування репозиторію

```bash
git clone [https://github.com/Hawk5757/CurrencyExchangeRateAggregator.git](https://github.com/Hawk5757/CurrencyExchangeRateAggregator.git)
cd CurrencyExchangeRateAggregator